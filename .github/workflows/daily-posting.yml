name: Daily Posting Cron

on:
  schedule:
    - cron: '0 0 * * *'  # 매일 00:00 UTC = 09:00 KST
  workflow_dispatch:  # 수동 실행 가능

jobs:
  posting:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        include:
          - subdomain: '00001'
            name: '상상피아노'
          - subdomain: '00002'
            name: '제이공방'
          - subdomain: '00003'
            name: '상상피아노 Japan'
          - subdomain: '00004'
            name: '제이공방 Thailand'
      max-parallel: 5  # 동시 최대 5개 실행
      fail-fast: false  # 하나 실패해도 나머지 계속 실행

    steps:
      - name: Post ${{ matrix.subdomain }} (${{ matrix.name }})
        run: |
          curl -X POST "https://make-page.com/test-posting" \
            -H "Content-Type: application/json" \
            -d '{"subdomain":"${{ matrix.subdomain }}"}' \
            --max-time 120 \
            --fail-with-body
