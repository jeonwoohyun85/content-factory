# 공통 설정
name = "make-page-subdomain"
main = "make-page-subdomain.js"
compatibility_date = "2024-01-01"
account_id = "73506724e3c7dd97bc939983761a90cf"

# Production 환경 (기본)
[env.production]
usage_model = "unbound"

routes = [
  { pattern = "make-page.com/*", zone_id = "6336f0fab5cb7b480e1f7b44698aef60" },
  { pattern = "*.make-page.com/*", zone_id = "6336f0fab5cb7b480e1f7b44698aef60" }
]

[env.production.triggers]
crons = ["0 0 * * *"]  # 매일 한국시간 09:00 (UTC 00:00)

[[env.production.queues.producers]]
queue = "posting-queue"
binding = "POSTING_QUEUE"

[[env.production.queues.consumers]]
queue = "posting-queue"
max_batch_size = 5
max_batch_timeout = 30
max_retries = 1

[env.production.vars]
API_BASE_URL = "https://caps-chatbot.fly.dev"
SHEETS_ID = "1KrzLFi8Wt9GTGT97gcMoXnbZ3OJ04NsP4lncJyIdyhU"
DRIVE_FOLDER_ID = "1JiVmIkliR9YrPIUPOn61G8Oh7h9HTMEt"

# Staging 환경
[env.staging]
usage_model = "unbound"

routes = [
  { pattern = "staging.make-page.com/*", zone_id = "6336f0fab5cb7b480e1f7b44698aef60" },
  { pattern = "*.staging.make-page.com/*", zone_id = "6336f0fab5cb7b480e1f7b44698aef60" }
]

[env.staging.triggers]
crons = []

[env.staging.vars]
API_BASE_URL = "https://caps-staging.fly.dev"
SHEETS_ID = "1KrzLFi8Wt9GTGT97gcMoXnbZ3OJ04NsP4lncJyIdyhU"
DRIVE_FOLDER_ID = "1JiVmIkliR9YrPIUPOn61G8Oh7h9HTMEt"
